# 第九章：双样本推断——侦探的对决分析

到目前为止, 我们的“法庭辩论”还只是让一个“嫌疑人”(样本)与一个“已知的旧案标准”(总体参数的假设值)进行比较. 但在现实中, 侦探们更常遇到的情况是**直接比较两个嫌疑人**, 看他们到底是不是一伙的, 或者谁的嫌疑更大. 这就是**双样本推断 (Two-Sample Inference)** 的核心: 比较两个不同的总体.

---

## 9.1 核心问题：独立还是配对？

在进行双样本对决分析前, 你必须先回答一个至关重要的问题: 这两个样本是**独立的 (Independent)** 还是**配对的 (Paired/Dependent)**? 这决定了你使用哪一套“辩论法则”.

*   **独立样本 (Independent Samples)**: 两个样本的抽取过程毫无关联. 一个样本中的个体与另一个样本中的个体是完全不同的两拨人.
    *   **比喻**: 随机抽取50名男生和50名女生, 比较他们的平均身高. 这两组人之间没有天然的对应关系.

*   **配对样本 (Paired Samples)**: 两个样本中的数据存在着一一对应的“配对”关系. 很多时候, 这表现为“同一个对象处理前后的对比”.
    *   **比喻**: 随机抽取50个人, 记录他们“减肥前”的体重和“减肥后”的体重. 这里的“张三减肥前的体重”和“张三减肥后的体重”就是一对天然的配对数据.
    *   **处理技巧**: 对于配对样本, 我们通常不直接比较两组数据, 而是先计算每对数据之间的**差值 (Difference)**, 然后把问题**转化为单样本T检验**来分析这些“差值”. 我们的核心问题变成了“这些差值的平均数是否显著不为零?”.

---

## 9.2 双样本比例的对决 (2-Proportion Test and Interval)

*   **应用场景**: 比较两个不同总体的**比例**是否存在差异.
*   *例子*: “A大学的毕业生就业率是否真的高于B大学?” 或者 “使用新广告后, 产品的点击率是否与旧广告有显著不同?”

#### 假设检验 ($H_0: p_1 = p_2$)
*   **原假设**: 两个总体的比例没有差异 ($p_1 = p_2$ 或 $p_1 - p_2 = 0$).
*   **备择假设**: 两个总体的比例存在差异 ($p_1 
e p_2$, $p_1 > p_2$, 或 $p_1 < p_2$).
*   **前提条件**: 与单样本比例检验类似, 但需要保证两个样本都满足条件(随机、独立、样本量足够大).

#### 置信区间 (Interval for $p_1 - p_2$)
*   **目标**: 估计两个总体比例**差值**的真实范围.
*   **解读**: 如果计算出的95%置信区间是 [0.02, 0.08], 我们可以说: “我们有95%的信心认为, 总体A的比例比总体B的比例高出2%到8%.”
*   **与假设检验的联系**: 如果这个区间**不包含0**, 就等同于在 $\alpha=0.05$ 的水平上拒绝了“$p_1 = p_2$”的原假设.

---

## 9.3 双样本均值的对决 (2-Sample T-Test and Interval)

*   **应用场景**: 比较两个不同总体的**均值**是否存在差异.
*   *例子*: “服用新药的病人平均康复时间是否比服用旧药的病人更短?” 或者 “A、B两种轮胎的平均磨损里程是否有显著差异?”

#### 1. 配对样本T检验 (Paired T-Test)
*   **分析对象**: 如前所述, 先计算出每对数据的**差值**, 然后对这些**差值**进行**单样本T检验**.
*   **原假设**: $H_0: \mu_d = 0$ (平均差值为0, 意味着处理前后没有变化).
*   **备择假设**: $H_a: \mu_d \ne 0$ (平均差值不为0, 意味着处理有效).
*   **前提条件**: 差值样本是随机的, 并且差值数据所代表的总体服从正态分布(或差值样本量足够大).

#### 2. 独立样本T检验 (Independent T-Test)
*   **分析对象**: 直接比较两个独立的样本.
*   **原假设**: $H_0: \mu_1 = \mu_2$ (两个总体的均值没有差异).
*   **备择假设**: $H_a: \mu_1 \ne \mu_2$ (两个总体的均值存在差异).
*   **前提条件**:
    1.  两个样本都是随机抽取的.
    2.  两个样本是相互独立的.
    3.  两个总体都服从正态分布, **或者** 两个样本的容量都足够大($n_1 \ge 30$ 且 $n_2 \ge 30$). 

> **一个历史注记**: 过去, 独立样本T检验还需要区分“两总体方差是否相等”的情况. 但现代统计软件(如R)默认使用的“韦尔奇T检验”(Welch's T-test)已经很好地处理了方差不相等的情况, 因此我们通常不再需要为这个前提操心.

---

## 9.4 如何选择正确的分析方法？

面对一个实际问题, 你可以像侦探一样按以下步骤思考, 找到正确的分析工具:

1.  **问题类型**: 我关心的是**均值(mean)**还是**比例(proportion)**?
    *   如果是测量值(身高、时间、分数), 那是“均值”问题.
    *   如果是计数值(支持/反对, 合格/不合格), 那是“比例”问题.
2.  **样本数量**: 我是在分析**一个总体**还是在比较**两个总体**?
3.  **样本关系(如果是两个样本)**: 这两个样本是**独立的**还是**配对的**?
4.  **分析目的**: 我是想做一个“是/否”的**假设检验**, 还是想估计一个范围的**置信区间**?

通过回答这四个问题, 你就能精确地定位到你应该使用的具体统计方法, 无论是单样本Z检验、双样本T检验, 还是配对样本的置信区间等等. 这标志着你已经从一个只会使用工具的侦探, 成长为一个能根据案情选择最合适工具的策略家.
